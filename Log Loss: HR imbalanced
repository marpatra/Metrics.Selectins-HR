import numpy as np

# Sample data for Cardio (n/y) and Thal
Cardio = [
    0, 1, 1, 0, 0, 0, 1, 0, 1, 1,
    0, 0, 1, 0, 0, 0, 1, 0, 0, 0,
    0, 0, 1, 1, 1, 0, 0, 0, 0, 1,
    0, 1, 1, 0, 0, 0, 1, 1, 1, 0,
    1, 0, 0, 0, 1, 1, 0, 1, 0, 0,
    0, 0, 1, 0, 1, 1, 1, 1, 0, 0,
    1, 0, 1, 0, 1, 1, 1, 0, 1, 1,
    0, 1, 1, 1, 0, 1, 0, 0, 1, 0,
    0, 1, 1, 0, 1, 0, 0, 0, 0, 0,
    1, 0, 0, 0, 0, 0, 1, 0, 0, 1,
    0, 1, 1, 1, 0, 0, 1, 0, 1, 0,
    1, 1, 1, 1, 0, 1, 0, 0, 1, 0,
    1, 1, 0, 1, 1, 0, 1, 0, 1, 1,
    0, 1, 0, 1, 0, 0, 0, 0, 0, 0,
    1, 1, 1, 0, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 0, 0, 0, 1, 1, 0, 1,
    0, 0, 0, 1, 1, 0, 1, 1, 1, 1,
    0, 0, 0, 1, 0, 1, 1, 0, 0, 0,
    0, 1, 0, 1, 0, 1, 0, 1, 1, 1,
    1, 1, 1, 0, 1, 0, 0, 1, 0, 1,
    0, 1, 0, 1, 1, 0, 1, 0, 1, 0,
    0, 1, 0, 0, 0, 0, 0, 0, 1, 0,
    0, 1, 0, 0, 0, 0, 0, 0, 1, 1,
    0, 0, 1, 1, 1, 1, 0, 1, 0, 0,
    0, 0, 0, 0, 0, 1, 1, 0, 0, 1,
    0, 0, 0, 1, 1, 0, 1, 1, 0, 1,
    0, 1, 0, 1, 0, 1, 0, 0, 1, 0,
    1, 0, 0, 1, 1, 0, 1, 0, 1, 0,
    1, 0, 0, 0, 1, 0, 1, 0, 0, 0,
    1, 0, 1, 1
]

Thal = [
    6, 3, 7, 3, 3, 3, 3, 3, 7, 7,
    6, 3, 6, 7, 7, 3, 7, 3, 3, 3,
    3, 3, 3, 7, 7, 3, 3, 3, 3, 7,
    3, 7, 3, 7, 3, 3, 7, 6, 7, 3,
    7, 7, 3, 3, 3, 7, 3, 7, 3, 3,
    3, 7, 3, 3, 7, 7, 7, 7, 3, 3,
    7, 3, 7, 3, 7, 7, 3, 7, 7, 3,
    3, 7, 7, 6, 3, 3, 7, 7, 7, 7,
    7, 7, 3, 6, 7, 7, 6, 3, 3, 7,
    7, 7, 7, 3, 7, 3, 3, 7, 7, 3,
    3, 7, 7, 7, 3, 3, 7, 3, 7, 7,
    3, 3, 7, 7, 7, 3, 3, 3, 3, 3,
    3, 3, 7, 3, 7, 7, 3, 3, 3, 3,
    3, 7, 7, 7, 3, 3, 7, 3, 7, 3,
    7, 7, 7, 7, 3, 7, 3, 3, 7, 6,
    7, 7, 3, 7, 3, 3, 7, 7, 3, 3,
    7, 6, 7, 7, 3, 7, 7, 3, 3, 3,
    3, 3, 3, 7, 3, 7, 7, 7, 7, 3,
    3, 3, 3, 7, 3, 3, 7, 3, 7, 7,
    3, 7, 6, 6, 6, 7, 3, 7, 6, 7,
    3, 3, 7, 3, 3, 7, 3, 7, 3, 3,
    7, 3, 7, 3, 7, 6, 6, 7, 7, 3,
]

# Truncate the longer array to match the length of the shorter array
min_length = min(len(Thal), len(Cardio))
Thal = Thal[:min_length]
Cardio = Cardio[:min_length]

# Convert Cardio to numerical
Cardio_numeric = np.array(Cardio)

# Calculate log loss
y_true = Cardio_numeric
y_pred = np.array(Thal)
epsilon = 1e-15  # to prevent log(0) issues
y_pred = np.maximum(epsilon, y_pred)  # clip to prevent log(0)
y_pred = np.minimum(1 - epsilon, y_pred)  # clip to prevent log(1)
log_loss = -np.mean(y_true * np.log(y_pred) + (1 - y_true) * np.log(1 - y_pred))

print("Log Loss:", log_loss)
